<div align="center">

# ğŸ® å¼€æ”¾ä¸–ç•Œ NPC å¯¹è¯è®°å¿†æµ‹è¯•

åŸºäº **[mem0](https://github.com/mem0ai/mem0)** çš„å¼€æ”¾ä¸–ç•Œ NPC å¯¹è¯è®°å¿† Demo  
æ”¯æŒ **é•¿æœŸ / çŸ­æœŸ / è¿‡ç¨‹è®°å¿†**ï¼Œå¯åˆ‡æ¢ **MongoDB** æˆ– **PostgreSQLï¼ˆpgvectorï¼‰** å¯¹æ¯”å­˜å‚¨ä¸å¬å›è¡¨ç°

<img src="images/demo-1.png" alt="demo" width="800" />

</div>

---

## âœ¨ åŠŸèƒ½æ¦‚è§ˆ

| Tab | åŠŸèƒ½ |
|-----|------|
| **å¯¹è¯è®°å¿†** | ç©å®¶ä¸ NPC å¯¹è¯ â†’ è‡ªåŠ¨å¬å›è®°å¿† â†’ ç”Ÿæˆå›å¤ â†’ LLM åˆ¤å®šé•¿æœŸ/çŸ­æœŸå¹¶å†™å…¥ï¼›å¤‡æ³¨å±•ç¤ºåˆ¤å®šç»“æœä¸å¬å›å†…å®¹ |
| **è®°å¿†ç®¡ç†** | æŒ‰å…³é”®è¯æœç´¢ Â· æŒ‰ç©å®¶ ID è·å–/åˆ é™¤è®°å¿† |
| **çŸ­æœŸä¸è¿‡ç¨‹è®°å¿†** | æŒ‰ä¼šè¯ï¼ˆsession_idï¼‰/ æŒ‰è¿‡æœŸæ—¶é—´ / è¿‡ç¨‹è®°å¿†ï¼ˆæ­¥éª¤æµç¨‹ï¼‰ä¸‰ç§æ–¹å¼æ·»åŠ  |

> å³ä¾§æ—¥å¿—é¢æ¿ï¼ˆSSE å®æ—¶æ¨é€ï¼‰åœ¨æ‰€æœ‰ Tab ä¸­å…±ç”¨ã€‚

---

## ğŸ§  è®°å¿†ç±»å‹è¯´æ˜

| ç±»å‹ | åŒºåˆ†æ–¹å¼ | é€‚ç”¨åœºæ™¯ | å­˜å‚¨ / æ£€ç´¢ |
|:-----|:---------|:---------|:------------|
| **é•¿æœŸè®°å¿†** | `user_id`ï¼Œä¸è®¾è¿‡æœŸ | ç”¨æˆ·åå¥½ã€è´¦æˆ·ä¿¡æ¯ã€é‡è¦äº‹å® | æ°¸ä¹…ä¿å­˜ï¼ŒæŒ‰ `user_id` + `agent_id` æ£€ç´¢ |
| **çŸ­æœŸè®°å¿†ï¼ˆä¼šè¯ï¼‰** | `session_id`ï¼ˆmem0 å†…éƒ¨ `run_id`ï¼‰ | å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡ã€å¤šæ­¥ä»»åŠ¡ | ä¼šè¯ç»“æŸå¯æ¸…ç©ºï¼Œå¯¹è¯æ—¶ä¸€å¹¶æ£€ç´¢ |
| **çŸ­æœŸè®°å¿†ï¼ˆè¿‡æœŸï¼‰** | `expiration_date`ï¼ˆå¦‚ 7 å¤©åï¼‰ | ä¸´æ—¶æé†’ | è¿‡æœŸåä¸å†è¢«æ£€ç´¢ |
| **è¿‡ç¨‹è®°å¿†** | `memory_type=procedural_memory` | æ­¥éª¤ã€æµç¨‹ã€æ“ä½œè¯´æ˜ | æŒ‰ã€Œæ€ä¹ˆåšã€å¬å› |

### å†™å…¥è§„åˆ™

å¯¹è¯æ—¶ç”± LLM æ ¹æ®æœ¬è½®å†…å®¹åˆ¤å®šä¸ºã€Œ**é•¿æœŸç±»**ã€æˆ–ã€Œ**çŸ­æœŸç±»**ã€ï¼š

- **é•¿æœŸç±»**ï¼ˆç”¨æˆ·åå¥½ã€è´¦æˆ·ä¿¡æ¯ã€é‡è¦äº‹å®ï¼‰â†’ å§‹ç»ˆæŒ‰é•¿æœŸè®°å¿†å†™å…¥ï¼Œä¸å¸¦ `session_id`
- **çŸ­æœŸç±»**ï¼ˆä¸Šä¸‹æ–‡ã€å¤šæ­¥ä»»åŠ¡ã€ä¸´æ—¶æé†’ï¼‰â†’ è¯·æ±‚å¸¦ `session_id`ï¼ŒæŒ‰çŸ­æœŸä¼šè¯è®°å¿†å†™å…¥ï¼ˆä¼  `run_id=session_id`ï¼‰

---

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

| å±‚ | æŠ€æœ¯ |
|----|------|
| åç«¯ | FastAPI Â· mem0ï¼ˆOSSï¼‰ Â· Voyage åµŒå…¥ Â· DeepSeek / Azure OpenAI |
| å‘é‡åº“ | MongoDB Atlas æˆ– PostgreSQLï¼ˆpgvectorï¼‰ |
| å‰ç«¯ | å•é¡µ HTML + åŸç”Ÿ JS Â· å·¦ä¾§å†…å®¹åŒº + å³ä¾§å¯æ‹–æ‹½æ—¥å¿—é¢æ¿ |

---

## ğŸ“ ç›®å½•ç»“æ„

```
mem0_memory_test_app/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ config.py              # ç¯å¢ƒå˜é‡ä¸é…ç½®
â”‚   â”œâ”€â”€ db_init.py             # å¯åŠ¨æ—¶åˆ›å»ºåº“/è¡¨/ç´¢å¼•ï¼ˆå­˜åœ¨åˆ™è·³è¿‡ï¼‰
â”‚   â”œâ”€â”€ memory_backends.py     # mem0 åŒåç«¯å°è£…ï¼ˆMongoDB / PostgreSQLï¼‰
â”‚   â”œâ”€â”€ main.py                # å¯¹è¯ã€è®°å¿†ç®¡ç†ã€æ—¥å¿—æµç­‰ API
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ run.sh                 # æ¨èå¯åŠ¨æ–¹å¼
â”‚   â””â”€â”€ .env.example           # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ index.html             # ä¸‰ Tab ç•Œé¢ + æ—¥å¿—é¢æ¿
â””â”€â”€ README.md
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•æˆ– `backend/` ä¸‹æ”¾ç½® `.env`ï¼Œå‚è€ƒ `backend/.env.example`ï¼š

| å˜é‡ | å¿…å¡« | è¯´æ˜ |
|------|:----:|------|
| `MONGODB_URI` | â–³ | MongoDB è¿æ¥ä¸²ï¼ˆè‡³å°‘é…ä¸€ä¸ªå‘é‡åº“ï¼‰ |
| `POSTGRES_URI` | â–³ | PostgreSQL è¿æ¥ä¸² |
| `VOYAGE_API_KEY` | âœ… | Voyage åµŒå…¥ï¼ˆmem0 ç”¨ï¼‰ |
| `DEEPSEEK_API_KEY` | âœ… | DeepSeekï¼ˆNPC å›å¤ + é•¿çŸ­è®°å¿†åˆ†ç±»ï¼‰ |
| `DEEPSEEK_MODEL` | | å¯é€‰ï¼Œé»˜è®¤ `deepseek-chat` |
| `AZURE_OPENAI_ENDPOINT` | | å¯é€‰ï¼Œç”¨ Azure åš NPC å›å¤æ—¶å¿…å¡« |
| `OPENAI_API_KEY` | | å¯é€‰ï¼ŒAzure æ—¶å¿…å¡« |
| `AZURE_DEPLOYMENT` | | å¯é€‰ï¼Œé»˜è®¤ `gpt-4o` |
| `AZURE_API_VERSION` | | å¯é€‰ï¼Œé»˜è®¤ `2024-02-15-preview` |

> â–³ è¡¨ç¤ºè‡³å°‘é…ç½®ä¸€ä¸ªå‘é‡åº“å³å¯ã€‚

---

## ğŸš€ æœ¬åœ°è¿è¡Œ

### 1. åç«¯ï¼ˆå¿…é¡»ï¼‰

**æ¨è**ï¼ˆä½¿ç”¨ `run.sh`ï¼‰ï¼š

```bash
cd mem0_memory_test_app/backend
./run.sh
```

**æ‰‹åŠ¨å¯åŠ¨**ï¼š

```bash
cd mem0_memory_test_app/backend
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
export PYTHONPATH=$(pwd)
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

> API æ–‡æ¡£ï¼š<http://127.0.0.1:8000/docs>

### 2. å‰ç«¯

```bash
cd mem0_memory_test_app/frontend
python -m http.server 5500
```

æµè§ˆå™¨æ‰“å¼€ <http://127.0.0.1:5500>ï¼Œé»˜è®¤è¯·æ±‚ `http://127.0.0.1:8000` ä½œä¸º APIã€‚

---

## ğŸ“– ä½¿ç”¨è¯´æ˜

### é¡µå¤´æ§åˆ¶æ 

| æ§ä»¶ | è¯´æ˜ |
|------|------|
| è®°å¿†åç«¯ | MongoDB / PostgreSQL åˆ‡æ¢ |
| NPC å›å¤ LLM | DeepSeek / Azure OpenAI |
| ç©å®¶ ID | åŒä¸€ ID ä¸‹è®°å¿†å…±ç”¨ï¼Œé»˜è®¤ `player-1` |
| å½“å‰ NPC | å¡«å†™åˆ™æŒ‰ã€Œç©å®¶ + NPCã€éš”ç¦»è®°å¿†ï¼›ç•™ç©ºä½¿ç”¨é»˜è®¤ `npc-default` |

### Tab 1 Â· å¯¹è¯è®°å¿†

- è¾“å…¥æ¶ˆæ¯ â†’ åç«¯å¬å›**é•¿æœŸ + å½“å‰ä¼šè¯çŸ­æœŸ**è®°å¿† â†’ ç”Ÿæˆ NPC å›å¤ â†’ åˆ¤å®šæœ¬è½®ä¸ºé•¿æœŸ/çŸ­æœŸå¹¶å†™å…¥
- æ¯æ¡å›å¤ä¸‹æ–¹å±•ç¤ºï¼š  
  `ç³»ç»Ÿåˆ¤å®šä¸º çŸ­æœŸ/é•¿æœŸ è®°å¿†ï¼Œæœ¬è½® NPC å¬å›çš„è®°å¿†`

### Tab 2 Â· è®°å¿†ç®¡ç†

- **æœç´¢è®°å¿†**ï¼šå…³é”®è¯ + æ¡æ•°ï¼ŒæŒ‰å½“å‰ç©å®¶ / NPC æœç´¢
- **æŒ‰ç©å®¶ ID è·å–**ï¼šå¯é€‰ NPCã€æ¡æ•°ï¼Œåˆ—å‡ºè¯¥èŒƒå›´è®°å¿†
- **æŒ‰ç©å®¶ ID åˆ é™¤**ï¼šæ¸…ç©ºè¯¥ç©å®¶ï¼ˆåŠå¯é€‰ NPCï¼‰ä¸‹å…¨éƒ¨è®°å¿†

### Tab 3 Â· çŸ­æœŸä¸è¿‡ç¨‹è®°å¿†

| åŠŸèƒ½ | æ“ä½œ |
|------|------|
| çŸ­æœŸï¼ˆæŒ‰ä¼šè¯ï¼‰ | è¾“å…¥å†…å®¹ + ä¼šè¯ IDï¼ˆç•™ç©ºç”¨å½“å‰é¡µä¼šè¯ï¼‰â†’ æ·»åŠ  / è·å– / æ¸…ç©º |
| çŸ­æœŸï¼ˆæŒ‰è¿‡æœŸæ—¶é—´ï¼‰ | è¾“å…¥å†…å®¹ + è¿‡æœŸå¤©æ•°ï¼ˆå¦‚ 7ï¼‰â†’ æ·»åŠ ï¼ŒN å¤©åè‡ªåŠ¨å¤±æ•ˆ |
| è¿‡ç¨‹è®°å¿† | è¾“å…¥æ­¥éª¤æµç¨‹æ–‡æœ¬ â†’ æ·»åŠ ï¼Œç±»å‹ä¸º `procedural_memory` |

> æ·»åŠ æ—¶å‡å¸¦ä¸Šå½“å‰ç©å®¶ ID ä¸ `agent_id`ï¼ˆä¸å¯¹è¯é»˜è®¤ä¸€è‡´ï¼‰ï¼Œä¿è¯å¯¹è¯èƒ½å¬å›ã€‚

---

## ğŸ“¡ API ä¸€è§ˆ

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|:----:|------|------|
| `POST` | `/chat` | å¯¹è¯ï¼šå¬å›è®°å¿† â†’ ç”Ÿæˆå›å¤ â†’ åˆ¤å®šé•¿çŸ­è®°å¿†å¹¶å†™å…¥ |
| `GET` | `/health` | å¥åº·æ£€æŸ¥ |
| `GET` | `/logs/stream` | SSE æœåŠ¡ç«¯æ—¥å¿—æµ |
| `POST` | `/memory/search` | è¯­ä¹‰æœç´¢è®°å¿† |
| `POST` | `/memory/add` | æ·»åŠ è®°å¿†ï¼ˆæ”¯æŒ `session_id` / `expiration_days` / `memory_type`ï¼‰ |
| `GET` | `/memory/by-user` | æŒ‰ç©å®¶ ID åˆ—å‡ºè®°å¿† |
| `GET` | `/memory/by-session` | æŒ‰ä¼šè¯åˆ—å‡ºçŸ­æœŸè®°å¿† |
| `GET` | `/memory/{memory_id}` | æŒ‰ ID è·å–å•æ¡ |
| `PATCH` | `/memory/{memory_id}` | æŒ‰ ID æ›´æ–°å†…å®¹ |
| `DELETE` | `/memory/{memory_id}` | æŒ‰ ID åˆ é™¤å•æ¡ |
| `DELETE` | `/memory` | æŒ‰èŒƒå›´åˆ é™¤ï¼ˆ`user_id` / `agent_id` / `session_id`ï¼‰ |

> å®Œæ•´å‚æ•°è§ <http://127.0.0.1:8000/docs>

---

## ğŸ—„ï¸ åº“è¡¨ä¸ç´¢å¼•

| åç«¯ | è‡ªåŠ¨åˆå§‹åŒ– |
|------|------------|
| **MongoDB** | æ•°æ®åº“ `mem0_agent_memory` â†’ é›†åˆ `extracted_memories` â†’ å‘é‡æœç´¢ç´¢å¼•ï¼ˆæ–°ç´¢å¼•çº¦ 1 åˆ†é’Ÿå°±ç»ªï¼‰ |
| **PostgreSQL** | `CREATE EXTENSION IF NOT EXISTS vector;`ï¼Œmem0 é¦–æ¬¡å†™å…¥æ—¶è‡ªåŠ¨å»ºè¡¨ |

> è‹¥åªæµ‹ä¸€ç§åç«¯ï¼Œä»…é…ç½®å¯¹åº” URI å³å¯ã€‚

---

## ğŸ“¦ ä¾èµ–

```
mem0ai  Â·  langchain-voyageai  Â·  pymongo  Â·  pgvector  Â·  psycopg2-binary
fastapi  Â·  uvicorn  Â·  openai  Â·  python-dotenv
```

è¯¦è§ `backend/requirements.txt`ã€‚
